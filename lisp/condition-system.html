<html>
<head>
	<title>Common Lisp Condition System</title>
	<script src="/scripts/jquery.js"></script>
	<script src="/scripts/copy-to-clipboard.js"></script>
	<script type="text/javascript" src="/scripts/highlight-lisp.js"></script>
	<link rel="stylesheet" href="/css/emacs-face.css">
	<link rel="stylesheet" type="text/css" href="/css/lisp.css">
</head>
<body>
<main>
	<h1>Guide: Common Lisp Condition System</h1>
	<p>This guide introduces the Common Lisp Condition System</p>
	<p>Test out <b>bold</b> and <i>italics</i> and <b><i>bolded italics</i></b></p>
	<code>
;; This is a comment
;; This too

(defun my-function ()
  "Return Nil")

(defun math-list (text)
  "Returns a list of math objects that exists within a string. Wrapper of math-structural-form"
  (let ((structural-form (structural-form text))
	(word-list (helper::string-to-list text)))
    (math-structural-form word-list structural-form)))

(defun math-structural-form (word-list structural-form &key (prior-list nil) (prior-struct nil))
  "Returns a list of the math objects that exist within a string"
  (cond ((null structural-form) prior-list)
	(t (let* ((word (car word-list))
		  (struct (car structural-form))
		  (current-list (cond
				  ((not (find #\% struct)) prior-list)
				  ((null prior-list) (list word))
				  ((or (equal prior-struct "%,")
				       (equal prior-struct "%;")
				       (equal prior-struct "%.")
				       (not (find #\% prior-struct)))
				   (append prior-list (list (if (or (equal struct "%,")
								      (equal struct "%;")
								      (equal struct "%."))
								  (subseq word 0 (- (length word) 1))
								  word))))
				  (t
				   (append (butlast prior-list)
					   (list (concatenate 'string (car (last prior-list))
							      (if (or (equal struct "%,")
								      (equal struct "%;")
								      (equal struct "%."))
								  (subseq word 0 (- (length word) 1))
								  word))))))))
	     (math-structural-form (rest word-list)
				   (rest structural-form)
				   :prior-list current-list
				   :prior-struct struct)))))

    </code>
	    <br />
		<br />
</main>
<script>
</script>
</body>
</html>